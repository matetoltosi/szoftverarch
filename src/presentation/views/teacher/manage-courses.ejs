<h2>Manage Courses</h2>

<form id="courseForm">
  <input id="courseName" placeholder="Course name" required>
  <select id="courseSubject"></select>
  <button>Create Course</button>
</form>

<ul id="courseList"></ul>

<script>
  async function loadSubjects() {
    const res = await fetch('/api/teacher/subjects');
    const subjects = await res.json();
    const select = document.getElementById('courseSubject');
    select.innerHTML = '';
    subjects.forEach(s => {
      const opt = document.createElement('option');
      opt.value = s._id;
      opt.textContent = s.name;
      select.appendChild(opt);
    });
  }

  async function loadCourses() {
    const res = await fetch('/api/teacher/courses');
    const courses = await res.json();
    const ul = document.getElementById('courseList');
    ul.innerHTML = '';
    courses.forEach(c => {
      const li = document.createElement('li');
      li.textContent = `${c.name} (${c.subjectId.name})`;
      ul.appendChild(li);
    });
  }

  document.getElementById('courseForm')
    .addEventListener('submit', async e => {
      e.preventDefault();

      await fetch('/api/teacher/courses', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          name: courseName.value,
          subjectId: courseSubject.value
        })
      });

      courseName.value = '';
      loadCourses();
    });

  loadSubjects();
  loadCourses();
</script>