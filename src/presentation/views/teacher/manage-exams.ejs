<h2>Manage Exams</h2>

<form id="examForm">
  <input id="examName" placeholder="Exam name" required>
  <input id="examDate" type="date">
  <select id="examSubject"></select>
  <button>Create Exam</button>
</form>

<ul id="examList"></ul>

<script>
async function loadSubjects() {
  const res = await fetch('/api/teacher/subjects');
  const subjects = await res.json();
  const select = document.getElementById('examSubject');
  select.innerHTML = '';
  subjects.forEach(s => {
    const opt = document.createElement('option');
    opt.value = s._id;
    opt.textContent = s.name;
    select.appendChild(opt);
  });
}

async function loadExams() {
  const res = await fetch('/api/teacher/exams');
  const exams = await res.json();
  const ul = document.getElementById('examList');
  ul.innerHTML = '';
  exams.forEach(e => {
    const li = document.createElement('li');
    li.textContent = `${e.name} (${e.subjectId.name})`;
    ul.appendChild(li);
  });
}

document.getElementById('examForm')
  .addEventListener('submit', async e => {
    e.preventDefault();

    await fetch('/api/teacher/exams', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        name: examName.value,
        subjectId: examSubject.value,
        date: examDate.value
      })
    });

    examName.value = '';
    loadExams();
  });

loadSubjects();
loadExams();
</script>